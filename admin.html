<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel - PT. Alumindo Jaya</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <div class="container py-5">
    <h1 class="mb-4">Panel Admin</h1>
    <p><a href="#" onclick="logout()" class="btn btn-outline-danger btn-sm">Logout</a></p>

    <h3>Tambah Produk</h3>
    <form id="productForm" class="mb-3">
      <div class="mb-3">
        <label class="form-label">Nama Produk</label>
        <input type="text" class="form-control" id="productName" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Deskripsi</label>
        <textarea class="form-control" id="productDesc" rows="2" required></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">Harga (Rp)</label>
        <input type="number" class="form-control" id="productPrice" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Kategori</label>
        <input type="text" class="form-control" id="productCategory" required>
      </div>
      <div class="mb-3">
        <label class="form-label">URL Gambar</label>
        <input type="url" class="form-control" id="productImage" required>
      </div>
      <button type="submit" class="btn btn-dark">Simpan Produk</button>
    </form>

    <table class="table table-bordered" id="productTable"></table>

    <h3>Tambah Proyek</h3>
    <form id="projectForm" class="mb-3">
      <div class="mb-3">
        <label class="form-label">Judul Proyek</label>
        <input type="text" class="form-control" id="projectTitle" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Deskripsi</label>
        <textarea class="form-control" id="projectDesc" rows="2" required></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">URL Gambar</label>
        <input type="url" class="form-control" id="projectImage" required>
      </div>
      <button type="submit" class="btn btn-dark">Simpan Proyek</button>
    </form>

    <table class="table table-bordered" id="projectTable"></table>

    <h3>Tambah Testimoni</h3>
    <form id="testimonialForm" class="mb-3">
      <div class="mb-3">
        <label class="form-label">Isi Testimoni</label>
        <textarea class="form-control" id="testimonialText" rows="2" required></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">Nama Klien</label>
        <input type="text" class="form-control" id="testimonialAuthor" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Kota</label>
        <input type="text" class="form-control" id="testimonialCity" required>
      </div>
      <button type="submit" class="btn btn-dark">Simpan Testimoni</button>
    </form>

    <table class="table table-bordered" id="testimonialTable"></table>

    <h3>Tambah Gambar Galeri</h3>
    <form id="galleryForm" class="mb-3">
      <div class="mb-3">
        <label class="form-label">URL Gambar</label>
        <input type="url" class="form-control" id="galleryImage" required>
      </div>
      <button type="submit" class="btn btn-dark">Simpan Gambar</button>
    </form>

    <table class="table table-bordered" id="galleryTable"></table>

    <h3>Dashboard Statistik</h3>
    <div id="dashboardStats" class="mt-4">
      <p><strong>Total Produk:</strong> <span id="statProducts">0</span></p>
      <p><strong>Total Proyek:</strong> <span id="statProjects">0</span></p>
      <p><strong>Total Testimoni:</strong> <span id="statTestimonials">0</span></p>
      <p><strong>Total Gambar Galeri:</strong> <span id="statGallery">0</span></p>
    </div>
  </div>

  <script>
    if (localStorage.getItem('isAdminLoggedIn') !== 'true') {
      window.location.href = 'login.html';
    }

    function logout() {
      localStorage.removeItem('isAdminLoggedIn');
      window.location.href = 'login.html';
    }

    function updateStats() {
      document.getElementById('statProducts').textContent = (JSON.parse(localStorage.getItem('products')) || []).length;
      document.getElementById('statProjects').textContent = (JSON.parse(localStorage.getItem('projects')) || []).length;
      document.getElementById('statTestimonials').textContent = (JSON.parse(localStorage.getItem('testimonials')) || []).length;
      document.getElementById('statGallery').textContent = (JSON.parse(localStorage.getItem('gallery')) || []).length;
    }

    function renderTables() {
      const products = JSON.parse(localStorage.getItem('products')) || [];
      let html = '<tr><th>Nama</th><th>Deskripsi</th><th>Harga</th><th>Kategori</th><th>Aksi</th></tr>';
      products.forEach((p, i) => {
        html += `<tr><td>${p.name}</td><td>${p.desc}</td><td>${p.price}</td><td>${p.category}</td><td><button onclick="deleteItem('products', ${i})" class="btn btn-sm btn-danger">Hapus</button></td></tr>`;
      });
      document.getElementById('productTable').innerHTML = html;

      const projects = JSON.parse(localStorage.getItem('projects')) || [];
      html = '<tr><th>Judul</th><th>Deskripsi</th><th>Aksi</th></tr>';
      projects.forEach((p, i) => {
        html += `<tr><td>${p.title}</td><td>${p.desc}</td><td><button onclick="deleteItem('projects', ${i})" class="btn btn-sm btn-danger">Hapus</button></td></tr>`;
      });
      document.getElementById('projectTable').innerHTML = html;

      const testimonials = JSON.parse(localStorage.getItem('testimonials')) || [];
      html = '<tr><th>Isi</th><th>Nama</th><th>Kota</th><th>Aksi</th></tr>';
      testimonials.forEach((t, i) => {
        html += `<tr><td>${t.text}</td><td>${t.author}</td><td>${t.city}</td><td><button onclick="deleteItem('testimonials', ${i})" class="btn btn-sm btn-danger">Hapus</button></td></tr>`;
      });
      document.getElementById('testimonialTable').innerHTML = html;

      const gallery = JSON.parse(localStorage.getItem('gallery')) || [];
      html = '<tr><th>URL Gambar</th><th>Aksi</th></tr>';
      gallery.forEach((g, i) => {
        html += `<tr><td><img src="${g}" alt="Gambar Galeri" style="width: 100px; height: auto;"></td><td><button onclick="deleteItem('gallery', ${i})" class="btn btn-sm btn-danger">Hapus</button></td></tr>`;
      });
      document.getElementById('galleryTable').innerHTML = html;
    }

    function deleteItem(type, index) {
      const data = JSON.parse(localStorage.getItem(type)) || [];
      data.splice(index, 1);
      localStorage.setItem(type, JSON.stringify(data));
      updateStats();
      renderTables();
    }

    document.getElementById('productForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const products = JSON.parse(localStorage.getItem('products')) || [];
      products.push({
        name: document.getElementById('productName').value,
        desc: document.getElementById('productDesc').value,
        price: document.getElementById('productPrice').value,
        category: document.getElementById('productCategory').value,
        image: document.getElementById('productImage').value
      });
      localStorage.setItem('products', JSON.stringify(products));
      alert('Produk disimpan!');
      this.reset();
      updateStats();
      renderTables();
    });

    document.getElementById('projectForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const projects = JSON.parse(localStorage.getItem('projects')) || [];
      projects.push({
        title: document.getElementById('projectTitle').value,
        desc: document.getElementById('projectDesc').value,
        image: document.getElementById('projectImage').value
      });
      localStorage.setItem('projects', JSON.stringify(projects));
      alert('Proyek disimpan!');
      this.reset();
      updateStats();
      renderTables();
    });

    document.getElementById('testimonialForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const testimonials = JSON.parse(localStorage.getItem('testimonials')) || [];
      testimonials.push({
        text: document.getElementById('testimonialText').value,
        author: document.getElementById('testimonialAuthor').value,
        city: document.getElementById('testimonialCity').value
      });
      localStorage.setItem('testimonials', JSON.stringify(testimonials));
      alert('Testimoni disimpan!');
      this.reset();
      updateStats();
      renderTables();
    });

    document.getElementById('galleryForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const gallery = JSON.parse(localStorage.getItem('gallery')) || [];
      gallery.push(document.getElementById('galleryImage').value);
      localStorage.setItem('gallery', JSON.stringify(gallery));
      alert('Gambar galeri disimpan!');
      this.reset();
      updateStats();
      renderTables();
    });

    updateStats();
    renderTables();
  </script>
</body>
</html>
